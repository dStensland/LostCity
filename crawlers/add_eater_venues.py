#!/usr/bin/env python3
"""
Add venues from Eater Atlanta's best restaurants, bars, and cocktail spots.
These are dining/drinking venues, not event venues with calendars.

Source: https://atlanta.eater.com/maps/38-best-restaurants-in-atlanta
        https://atlanta.eater.com/maps/best-new-cocktail-bars-atlanta
        https://atlanta.eater.com/maps/best-sports-bars-atlanta
"""

import logging
from db import get_or_create_venue, get_venue_by_slug

logging.basicConfig(level=logging.INFO, format="%(message)s")
logger = logging.getLogger(__name__)

# Eater 38 Best Restaurants
RESTAURANTS = [
    {
        "name": "Talat Market",
        "slug": "talat-market",
        "address": "112 Ormond St SE",
        "neighborhood": "Summerhill",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30315",
        "lat": 33.7401,
        "lng": -84.3789,
        "venue_type": "restaurant",
        "website": "https://talatmarketatl.com",
    },
    {
        "name": "Little Bear",
        "slug": "little-bear",
        "address": "71 Georgia Ave SE Unit A",
        "neighborhood": "Summerhill",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30312",
        "lat": 33.7415,
        "lng": -84.3825,
        "venue_type": "restaurant",
        "website": "https://www.littlebearatl.com",
    },
    {
        "name": "Tassili's Raw Reality Cafe",
        "slug": "tassilis-raw-reality",
        "address": "1059 Ralph David Abernathy Blvd",
        "neighborhood": "West End",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30310",
        "lat": 33.7392,
        "lng": -84.4183,
        "venue_type": "restaurant",
        "website": "https://tassilis.com",
    },
    {
        "name": "Gunshow",
        "slug": "gunshow",
        "address": "924 Garrett St SE Ste C",
        "neighborhood": "Glenwood Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30316",
        "lat": 33.7401,
        "lng": -84.3508,
        "venue_type": "restaurant",
        "website": "https://gunshowatl.com",
    },
    {
        "name": "La Semilla",
        "slug": "la-semilla",
        "address": "780 Memorial Dr SE Unit 4A",
        "neighborhood": "Grant Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30316",
        "lat": 33.7459,
        "lng": -84.3605,
        "venue_type": "restaurant",
        "website": "https://lasemillaatl.com",
    },
    {
        "name": "Poor Hendrix",
        "slug": "poor-hendrix",
        "address": "2371 Hosea L Williams Dr SE",
        "neighborhood": "East Lake",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30317",
        "lat": 33.7571,
        "lng": -84.3183,
        "venue_type": "bar",
        "website": "https://poorhendrix.com",
    },
    {
        "name": "Staplehouse",
        "slug": "staplehouse",
        "address": "541 Edgewood Ave NE",
        "neighborhood": "Old Fourth Ward",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30312",
        "lat": 33.7559,
        "lng": -84.3689,
        "venue_type": "restaurant",
        "website": "https://staplehouse.com",
    },
    {
        "name": "Busy Bee Cafe",
        "slug": "busy-bee-cafe",
        "address": "810 Martin Luther King Jr Dr NW",
        "neighborhood": "Vine City",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30314",
        "lat": 33.7571,
        "lng": -84.4103,
        "venue_type": "restaurant",
        "website": "https://busybeecafe.com",
    },
    {
        "name": "BoccaLupo",
        "slug": "boccalupo",
        "address": "753 Edgewood Ave NE",
        "neighborhood": "Inman Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30307",
        "lat": 33.7565,
        "lng": -84.3604,
        "venue_type": "restaurant",
        "website": "https://bfrg.com/boccalupo",
    },
    {
        "name": "Ticonderoga Club",
        "slug": "ticonderoga-club",
        "address": "99 Krog St NE",
        "neighborhood": "Inman Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30307",
        "lat": 33.7581,
        "lng": -84.3636,
        "venue_type": "bar",
        "website": "https://ticonderogaclub.com",
    },
    {
        "name": "Delbar",
        "slug": "delbar",
        "address": "870 Inman Village Pkwy NE",
        "neighborhood": "Inman Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30307",
        "lat": 33.7612,
        "lng": -84.3551,
        "venue_type": "restaurant",
        "website": "https://delbarrestaurant.com",
    },
    {
        "name": "Kimball House",
        "slug": "kimball-house",
        "address": "303 E Howard Ave",
        "neighborhood": "Decatur",
        "city": "Decatur",
        "state": "GA",
        "zip": "30030",
        "lat": 33.7713,
        "lng": -84.2929,
        "venue_type": "restaurant",
        "website": "https://kimball-house.com",
    },
    {
        "name": "Tio Lucho's",
        "slug": "tio-luchos",
        "address": "675 N Highland Ave NE Ste 6000",
        "neighborhood": "Poncey-Highland",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30306",
        "lat": 33.7721,
        "lng": -84.3559,
        "venue_type": "restaurant",
        "website": "https://tioluchos.com",
    },
    {
        "name": "Southern Belle",
        "slug": "southern-belle",
        "address": "1043 Ponce de Leon Ave NE",
        "neighborhood": "Poncey-Highland",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30306",
        "lat": 33.7745,
        "lng": -84.3556,
        "venue_type": "restaurant",
        "website": "https://southernbelleatl.com",
    },
    {
        "name": "Chai Pani",
        "slug": "chai-pani",
        "address": "406 W Ponce de Leon Ave",
        "neighborhood": "Decatur",
        "city": "Decatur",
        "state": "GA",
        "zip": "30030",
        "lat": 33.7745,
        "lng": -84.2965,
        "venue_type": "restaurant",
        "website": "https://chaipani.com",
    },
    {
        "name": "Avize",
        "slug": "avize",
        "address": "956 Brady Ave NW",
        "neighborhood": "West Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7812,
        "lng": -84.4148,
        "venue_type": "restaurant",
        "website": "https://avizeatl.com",
    },
    {
        "name": "Lazy Betty",
        "slug": "lazy-betty",
        "address": "999 Peachtree St NE",
        "neighborhood": "Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30309",
        "lat": 33.7812,
        "lng": -84.3839,
        "venue_type": "restaurant",
        "website": "https://lazybettyatl.com",
    },
    {
        "name": "Miller Union",
        "slug": "miller-union",
        "address": "999 Brady Ave NW",
        "neighborhood": "Westside",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7815,
        "lng": -84.4152,
        "venue_type": "restaurant",
        "website": "https://millerunion.com",
    },
    {
        "name": "Highland Tap",
        "slug": "highland-tap",
        "address": "1026 N Highland Ave NE",
        "neighborhood": "Virginia-Highland",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30306",
        "lat": 33.7865,
        "lng": -84.3515,
        "venue_type": "restaurant",
        "website": "https://highlandtap.com",
    },
    {
        "name": "Antico Pizza Napoletana",
        "slug": "antico-pizza",
        "address": "1093 Hemphill Ave NW",
        "neighborhood": "Westside",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7858,
        "lng": -84.4068,
        "venue_type": "restaurant",
        "website": "https://littleitalia.com",
    },
    {
        "name": "Mujo",
        "slug": "mujo",
        "address": "691 14th St NW",
        "neighborhood": "West Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7865,
        "lng": -84.4048,
        "venue_type": "restaurant",
        "website": "https://mujoatl.com",
    },
    {
        "name": "Twisted Soul Cookhouse & Pours",
        "slug": "twisted-soul",
        "address": "1133 Huff Rd NW #D",
        "neighborhood": "Westside",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7898,
        "lng": -84.4215,
        "venue_type": "restaurant",
        "website": "https://twistedsoulcookhouseandpours.com",
    },
    {
        "name": "Bacchanalia",
        "slug": "bacchanalia",
        "address": "1460 Ellsworth Industrial Blvd NW",
        "neighborhood": "Westside",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7938,
        "lng": -84.4295,
        "venue_type": "restaurant",
        "website": "https://starprovisions.com/bacchanalia",
    },
    {
        "name": "Daily Chew",
        "slug": "daily-chew",
        "address": "2127 Liddell Dr NE",
        "neighborhood": "Lindbergh",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30324",
        "lat": 33.8128,
        "lng": -84.3659,
        "venue_type": "restaurant",
        "website": "https://dailychew.com",
    },
    {
        "name": "Desta Ethiopian Kitchen",
        "slug": "desta-ethiopian",
        "address": "2250 Marietta Blvd NW Ste 206",
        "neighborhood": "Marietta Blvd",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.8045,
        "lng": -84.4398,
        "venue_type": "restaurant",
        "website": "https://destakitchen.com",
    },
    {
        "name": "Lucian Books and Wine",
        "slug": "lucian-books-wine",
        "address": "3005 Peachtree Rd NE Suite 300",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8398,
        "lng": -84.3789,
        "venue_type": "bar",
        "website": "https://lucianatl.com",
    },
    {
        "name": "Aria",
        "slug": "aria-atlanta",
        "address": "490 E Paces Ferry Rd NE",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8418,
        "lng": -84.3728,
        "venue_type": "restaurant",
        "website": "https://aria-atl.com",
    },
    {
        "name": "Atlas",
        "slug": "atlas-buckhead",
        "address": "88 W Paces Ferry Rd NW",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8392,
        "lng": -84.3798,
        "venue_type": "restaurant",
        "website": "https://atlasatlanta.com",
    },
    {
        "name": "The Chastain",
        "slug": "the-chastain",
        "address": "4320 Powers Ferry Rd NW",
        "neighborhood": "Chastain Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30342",
        "lat": 33.8718,
        "lng": -84.3758,
        "venue_type": "restaurant",
        "website": "https://thechastain.com",
    },
    {
        "name": "Kamayan ATL",
        "slug": "kamayan-atl",
        "address": "5150 Buford Hwy NE A230",
        "neighborhood": "Buford Highway",
        "city": "Doraville",
        "state": "GA",
        "zip": "30340",
        "lat": 33.8965,
        "lng": -84.2898,
        "venue_type": "restaurant",
        "website": "https://kamayanatl.com",
    },
    {
        "name": "LanZhou Ramen",
        "slug": "lanzhou-ramen",
        "address": "5231 Buford Hwy NE",
        "neighborhood": "Buford Highway",
        "city": "Doraville",
        "state": "GA",
        "zip": "30340",
        "lat": 33.8978,
        "lng": -84.2875,
        "venue_type": "restaurant",
        "website": None,
    },
    {
        "name": "Heirloom Market BBQ",
        "slug": "heirloom-market-bbq",
        "address": "2243 Akers Mill Rd SE",
        "neighborhood": "Vinings",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30339",
        "lat": 33.8658,
        "lng": -84.4598,
        "venue_type": "restaurant",
        "website": "https://heirloommarketbbq.com",
    },
    {
        "name": "Minhwa Spirits",
        "slug": "minhwa-spirits",
        "address": "2421 Van Fleet Circle",
        "neighborhood": "Doraville",
        "city": "Doraville",
        "state": "GA",
        "zip": "30360",
        "lat": 33.9125,
        "lng": -84.2715,
        "venue_type": "bar",
        "website": "https://minhwaspirits.com",
    },
    {
        "name": "NFA Burger",
        "slug": "nfa-burger",
        "address": "5465 Chamblee Dunwoody Rd",
        "neighborhood": "Dunwoody",
        "city": "Dunwoody",
        "state": "GA",
        "zip": "30338",
        "lat": 33.9228,
        "lng": -84.3218,
        "venue_type": "restaurant",
        "website": "https://nfaburger.com",
    },
    {
        "name": "Snackboxe Bistro",
        "slug": "snackboxe-bistro",
        "address": "1960 Day Drive NW",
        "neighborhood": "Duluth",
        "city": "Duluth",
        "state": "GA",
        "zip": "30096",
        "lat": 33.9658,
        "lng": -84.1458,
        "venue_type": "restaurant",
        "website": "https://snackboxe.com",
    },
    {
        "name": "9292 Korean BBQ",
        "slug": "9292-korean-bbq",
        "address": "3360 Satellite Blvd Ste 8",
        "neighborhood": "Duluth",
        "city": "Duluth",
        "state": "GA",
        "zip": "30096",
        "lat": 33.9625,
        "lng": -84.1298,
        "venue_type": "restaurant",
        "website": None,
    },
    {
        "name": "Hen Mother Cookhouse",
        "slug": "hen-mother-cookhouse",
        "address": "11705 Jones Bridge Rd",
        "neighborhood": "Johns Creek",
        "city": "Johns Creek",
        "state": "GA",
        "zip": "30005",
        "lat": 34.0258,
        "lng": -84.1958,
        "venue_type": "restaurant",
        "website": "https://henmothercookhouse.com",
    },
]

# Cocktail Bars
COCKTAIL_BARS = [
    {
        "name": "Redacted Basement Drink Parlor",
        "slug": "redacted-basement",
        "address": "63 Georgia Ave",
        "neighborhood": "Summerhill",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30312",
        "lat": 33.7418,
        "lng": -84.3825,
        "venue_type": "bar",
        "website": "https://redactedatl.com",
    },
    {
        "name": "Sammy's After Hours",
        "slug": "sammys-after-hours",
        "address": "565 Northside Dr SW",
        "neighborhood": "Adair Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30310",
        "lat": 33.7418,
        "lng": -84.4128,
        "venue_type": "bar",
        "website": None,
    },
    {
        "name": "Communidad Taqueria",
        "slug": "communidad-taqueria",
        "address": "655 Highland Ave NE",
        "neighborhood": "Inman Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30312",
        "lat": 33.7598,
        "lng": -84.3598,
        "venue_type": "restaurant",
        "website": "https://communidadtaqueria.com",
    },
    {
        "name": "Madeira Park",
        "slug": "madeira-park",
        "address": "640 North Highland Ave NE",
        "neighborhood": "Poncey-Highland",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30306",
        "lat": 33.7715,
        "lng": -84.3558,
        "venue_type": "bar",
        "website": "https://madeiraparkatl.com",
    },
    {
        "name": "Necessary Purveyor",
        "slug": "necessary-purveyor",
        "address": "639 Glen Iris Dr NE",
        "neighborhood": "Old Fourth Ward",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30308",
        "lat": 33.7718,
        "lng": -84.3668,
        "venue_type": "restaurant",
        "website": "https://necessarypurveyor.com",
    },
    {
        "name": "Fawn Wine + Amaro",
        "slug": "fawn-wine-amaro",
        "address": "119 East Ponce De Leon Ave",
        "neighborhood": "Decatur",
        "city": "Decatur",
        "state": "GA",
        "zip": "30030",
        "lat": 33.7745,
        "lng": -84.2938,
        "venue_type": "bar",
        "website": "https://fawnwinebar.com",
    },
    {
        "name": "Bar Avize",
        "slug": "bar-avize",
        "address": "956 Brady Ave NW",
        "neighborhood": "West Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30318",
        "lat": 33.7812,
        "lng": -84.4148,
        "venue_type": "bar",
        "website": "https://avizeatl.com",
    },
    {
        "name": "Elise",
        "slug": "elise-woodruff",
        "address": "1280 Peachtree St NE",
        "neighborhood": "Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30309",
        "lat": 33.7898,
        "lng": -84.3848,
        "venue_type": "bar",
        "website": "https://eliseatl.com",
    },
]

# Sports Bars (new ones not already in system)
SPORTS_BARS = [
    {
        "name": "Dave's Sports Bar & Grill",
        "slug": "daves-sports-bar",
        "address": "1155 Virginia Ave Ste K",
        "neighborhood": "Hapeville",
        "city": "Hapeville",
        "state": "GA",
        "zip": "30354",
        "lat": 33.6598,
        "lng": -84.4098,
        "venue_type": "bar",
        "website": None,
    },
    {
        "name": "Ideal Sportsbar",
        "slug": "ideal-sportsbar",
        "address": "1953 Lakewood Ave SE",
        "neighborhood": "Lakewood",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30315",
        "lat": 33.7198,
        "lng": -84.3628,
        "venue_type": "bar",
        "website": None,
    },
    {
        "name": "The Beverly",
        "slug": "the-beverly",
        "address": "790 Glenwood Ave SE Ste 260",
        "neighborhood": "Glenwood Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30316",
        "lat": 33.7418,
        "lng": -84.3518,
        "venue_type": "bar",
        "website": "https://thebeverlyatl.com",
    },
    {
        "name": "The Pub at EAV",
        "slug": "pub-eav",
        "address": "469 Flat Shoals Ave SE",
        "neighborhood": "East Atlanta Village",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30316",
        "lat": 33.7398,
        "lng": -84.3398,
        "venue_type": "bar",
        "website": "https://thepubeav.com",
    },
    {
        "name": "Skol Brewing Company",
        "slug": "skol-brewing",
        "address": "155 Carnegie Way NW",
        "neighborhood": "Downtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30303",
        "lat": 33.7578,
        "lng": -84.3918,
        "venue_type": "brewery",
        "website": "https://skolbrewingco.com",
    },
    {
        "name": "Painted Park",
        "slug": "painted-park",
        "address": "240 North Highland Ave NE",
        "neighborhood": "Inman Park",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30307",
        "lat": 33.7598,
        "lng": -84.3548,
        "venue_type": "bar",
        "website": "https://paintedpark.com",
    },
    {
        "name": "Pour Taproom Midtown",
        "slug": "pour-taproom-midtown",
        "address": "1180 Peachtree St NE",
        "neighborhood": "Midtown",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30309",
        "lat": 33.7858,
        "lng": -84.3838,
        "venue_type": "bar",
        "website": "https://pourtaproom.com",
    },
    {
        "name": "Brockett Pub House & Grill",
        "slug": "brockett-pub-house",
        "address": "4522 E Ponce de Leon Ave",
        "neighborhood": "Clarkston",
        "city": "Clarkston",
        "state": "GA",
        "zip": "30021",
        "lat": 33.8098,
        "lng": -84.2358,
        "venue_type": "bar",
        "website": "https://brockettatl.com",
    },
    {
        "name": "Whitehall Tavern",
        "slug": "whitehall-tavern",
        "address": "2391 Peachtree Rd",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8458,
        "lng": -84.3698,
        "venue_type": "bar",
        "website": "https://whitehalltavernatl.com",
    },
    {
        "name": "Irby's Tavern",
        "slug": "irbys-tavern",
        "address": "322 East Paces Ferry Rd NE",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8418,
        "lng": -84.3688,
        "venue_type": "bar",
        "website": "https://irbystavern.com",
    },
    {
        "name": "Industry Tavern",
        "slug": "industry-tavern",
        "address": "3280 Peachtree Rd NE #187",
        "neighborhood": "Buckhead",
        "city": "Atlanta",
        "state": "GA",
        "zip": "30305",
        "lat": 33.8498,
        "lng": -84.3628,
        "venue_type": "bar",
        "website": "https://industrytavernatl.com",
    },
    {
        "name": "Clay's Sports Cafe",
        "slug": "clays-sports-cafe",
        "address": "5975 Roswell Rd D-245",
        "neighborhood": "Sandy Springs",
        "city": "Sandy Springs",
        "state": "GA",
        "zip": "30328",
        "lat": 33.9258,
        "lng": -84.3558,
        "venue_type": "bar",
        "website": "https://clayssportscafe.com",
    },
]


def main():
    """Add all Eater Atlanta venues to database."""
    added = 0
    skipped = 0

    all_venues = RESTAURANTS + COCKTAIL_BARS + SPORTS_BARS

    logger.info(f"Processing {len(all_venues)} venues from Eater Atlanta...")
    logger.info("")

    for venue in all_venues:
        # Check if already exists
        existing = get_venue_by_slug(venue["slug"])
        if existing:
            logger.info(f"  SKIP: {venue['name']} (already exists)")
            skipped += 1
            continue

        # Add venue
        try:
            venue_id = get_or_create_venue(venue)
            logger.info(f"  ADD:  {venue['name']} -> ID {venue_id}")
            added += 1
        except Exception as e:
            logger.error(f"  ERROR: {venue['name']}: {e}")

    logger.info("")
    logger.info(f"Done! Added {added} venues, skipped {skipped} existing.")


if __name__ == "__main__":
    main()
