"""
Import Nashville Metro Organizations to event_producers table.
Comprehensive list of music industry, arts, nonprofit, business, and LGBTQ+ organizations.
"""

from db import get_client
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Nashville Metro Organizations
NASHVILLE_ORGS = [
    # ========== MUSIC INDUSTRY ORGANIZATIONS ==========
    {
        "name": "Country Music Association",
        "slug": "country-music-association",
        "org_type": "music_industry",
        "website": "https://cmaworld.com",
        "city": "Nashville",
        "neighborhood": "Music Row",
        "categories": ["music"],
        "description": "Trade organization supporting country music industry. Produces CMA Awards and CMA Fest, one of Nashville's largest music events.",
        "instagram": "cma",
        "facebook": "CountryMusicAssociation",
        "twitter": "CountryMusic",
    },
    {
        "name": "Americana Music Association",
        "slug": "americana-music-association",
        "org_type": "music_industry",
        "website": "https://americanamusic.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music"],
        "description": "Professional trade organization devoted to Americana music. Produces annual AmericanaFest and Honors & Awards show.",
        "instagram": "americanamusic",
        "facebook": "americanamusicassociation",
        "twitter": "AmericanaMusHQ",
    },
    {
        "name": "Nashville Songwriters Association International",
        "slug": "nashville-songwriters-association",
        "org_type": "music_industry",
        "website": "https://nashvillesongwriters.com",
        "city": "Nashville",
        "neighborhood": "Music Row",
        "categories": ["music"],
        "description": "World's largest not-for-profit songwriters trade organization. Offers workshops, events, and songwriter advocacy.",
        "instagram": "nashvillesongwriters",
        "facebook": "NashvilleSongwriters",
        "twitter": "NSAI",
    },
    {
        "name": "Gospel Music Association",
        "slug": "gospel-music-association",
        "org_type": "music_industry",
        "website": "https://gospelmusic.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music"],
        "description": "Serves the Gospel and Christian music industry. Produces Dove Awards and hosts educational events.",
        "instagram": "gospelmusicassociation",
        "facebook": "GospelMusicAssociation",
        "twitter": "TheGMAssoc",
    },
    {
        "name": "Musicians Hall of Fame and Museum",
        "slug": "musicians-hall-of-fame",
        "org_type": "music_museum",
        "website": "https://musicianshalloffame.com",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music", "art"],
        "description": "Museum and hall of fame honoring musicians of all genres. Hosts exhibits, events, and live performances.",
        "instagram": "musicianshallfame",
        "facebook": "musicianshallfame",
    },
    {
        "name": "Nashville Music Equality",
        "slug": "nashville-music-equality",
        "org_type": "nonprofit",
        "website": "https://nashvillemusicequality.org",
        "city": "Nashville",
        "categories": ["music"],
        "description": "Non-profit promoting diversity and inclusion in Nashville's music industry through education and advocacy.",
    },

    # ========== ARTS & CULTURE ORGANIZATIONS ==========
    {
        "name": "Metro Arts Nashville",
        "slug": "metro-arts-nashville",
        "org_type": "arts_nonprofit",
        "website": "https://www.nashville.gov/departments/metro-arts",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["art", "theater", "music"],
        "description": "Official arts commission of Metropolitan Nashville. Supports artists, grants, public art, and cultural programs citywide.",
        "instagram": "metroartsnashville",
        "facebook": "MetroArtsNashville",
        "twitter": "MetroArtsNash",
    },
    {
        "name": "OZ Arts Nashville",
        "slug": "oz-arts-nashville",
        "org_type": "arts_nonprofit",
        "website": "https://ozartsnashville.org",
        "city": "Nashville",
        "neighborhood": "WeGo",
        "categories": ["art", "theater", "music"],
        "description": "Contemporary arts center presenting multidisciplinary performances, exhibitions, and educational programs.",
        "instagram": "ozartsnashville",
        "facebook": "OzArtsNashville",
        "twitter": "OzArtsNash",
    },
    {
        "name": "Nashville Arts Coalition",
        "slug": "nashville-arts-coalition",
        "org_type": "arts_nonprofit",
        "website": "https://nashvilleartscoalition.com",
        "city": "Nashville",
        "categories": ["art", "music"],
        "description": "Collective of artists and organizations advocating for Nashville's creative community and cultural policy.",
        "instagram": "nashvilleartscoalition",
        "facebook": "NashvilleArtsCoalition",
    },
    {
        "name": "Frist Art Museum",
        "slug": "frist-art-museum",
        "org_type": "museum",
        "website": "https://fristartmuseum.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["art"],
        "description": "Premier visual arts museum in a stunning Art Deco building. Rotating exhibitions, family programs, and art classes.",
        "instagram": "fristartmuseum",
        "facebook": "FristArtMuseum",
        "twitter": "FristArtMuseum",
    },
    {
        "name": "Tennessee Performing Arts Center",
        "slug": "tennessee-performing-arts-center",
        "org_type": "performing_arts",
        "website": "https://tpac.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["theater", "music"],
        "description": "Major performing arts center hosting Broadway tours, Nashville Ballet, Nashville Opera, and special events.",
        "instagram": "tpacnashville",
        "facebook": "TPAC",
        "twitter": "TPAC",
    },
    {
        "name": "The Nashville Symphony",
        "slug": "nashville-symphony",
        "org_type": "performing_arts",
        "website": "https://nashvillesymphony.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music"],
        "description": "Grammy-winning orchestra performing classical, pops, and film concerts at Schermerhorn Symphony Center.",
        "instagram": "nashvillesymphony",
        "facebook": "NashvilleSymphony",
        "twitter": "NashSymphony",
    },
    {
        "name": "Nashville Ballet",
        "slug": "nashville-ballet",
        "org_type": "performing_arts",
        "website": "https://nashvilleballet.com",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["theater"],
        "description": "Professional ballet company presenting classical and contemporary works at TPAC and regional venues.",
        "instagram": "nashvilleballet",
        "facebook": "NashvilleBallet",
        "twitter": "NashvilleBallet",
    },
    {
        "name": "Nashville Opera",
        "slug": "nashville-opera",
        "org_type": "performing_arts",
        "website": "https://nashvilleopera.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music", "theater"],
        "description": "Opera company presenting classic and contemporary productions at TPAC and community venues.",
        "instagram": "nashvilleopera",
        "facebook": "NashvilleOpera",
        "twitter": "NashvilleOpera",
    },

    # ========== COMMUNITY NONPROFITS ==========
    {
        "name": "Nashville Public Library",
        "slug": "nashville-public-library",
        "org_type": "library",
        "website": "https://library.nashville.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["community", "family"],
        "description": "Public library system with 21 branches offering programs, events, maker spaces, and community resources.",
        "instagram": "nashvillepubliclibrary",
        "facebook": "NashvillePublicLibrary",
        "twitter": "Nashville_Lib",
    },
    {
        "name": "Hands On Nashville",
        "slug": "hands-on-nashville",
        "org_type": "nonprofit",
        "website": "https://hon.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Volunteer organization connecting people with service opportunities. Hosts annual GiveCamp and volunteer events.",
        "instagram": "handsonnashville",
        "facebook": "HandsOnNashville",
        "twitter": "HandsOnNash",
    },
    {
        "name": "Nashville Rescue Mission",
        "slug": "nashville-rescue-mission",
        "org_type": "nonprofit",
        "website": "https://nashvillerescuemission.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Homeless services organization offering shelter, meals, recovery programs, and community support.",
        "facebook": "NashvilleRescueMission",
        "instagram": "nrmnashville",
    },
    {
        "name": "Second Harvest Food Bank of Middle Tennessee",
        "slug": "second-harvest-food-bank",
        "org_type": "nonprofit",
        "website": "https://secondharvestmidtn.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Regional food bank serving 46 counties. Organizes food drives, volunteer opportunities, and hunger-relief events.",
        "instagram": "secondharvestmidtn",
        "facebook": "SecondHarvestMiddleTN",
        "twitter": "2HarvestMiddleTN",
    },
    {
        "name": "Habitat for Humanity Nashville",
        "slug": "habitat-for-humanity-nashville",
        "org_type": "nonprofit",
        "website": "https://habitatnashville.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Affordable housing nonprofit organizing build days, ReStore events, and home dedication ceremonies.",
        "instagram": "habitatnashville",
        "facebook": "GreaterNashvilleHabitat",
        "twitter": "HabitatNash",
    },
    {
        "name": "Nashville Farmers' Market",
        "slug": "nashville-farmers-market",
        "org_type": "public_market",
        "website": "https://nashvillefarmersmarket.org",
        "city": "Nashville",
        "neighborhood": "Germantown",
        "categories": ["food_drink", "community"],
        "description": "Year-round farmers market with vendors, restaurants, special events, and seasonal programming.",
        "instagram": "nashvillefarmersmarket",
        "facebook": "NashvilleFarmersMarket",
        "twitter": "ShopNFM",
    },

    # ========== BUSINESS & PROFESSIONAL ==========
    {
        "name": "Nashville Area Chamber of Commerce",
        "slug": "nashville-chamber",
        "org_type": "business",
        "website": "https://nashvillechamber.com",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["community"],
        "description": "Business advocacy and economic development organization. Hosts networking events, policy forums, and business conferences.",
        "instagram": "nashvillechamber",
        "facebook": "NashvilleChamber",
        "twitter": "NashvilleChamber",
    },
    {
        "name": "Nashville Technology Council",
        "slug": "nashville-technology-council",
        "org_type": "business",
        "website": "https://nashvilletechnologycouncil.com",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Tech industry association hosting networking events, educational programs, and startup support.",
        "instagram": "nashvilletechcouncil",
        "facebook": "nashvilletechnologycouncil",
        "twitter": "NashvilleTech",
    },
    {
        "name": "Nashville Entrepreneur Center",
        "slug": "nashville-entrepreneur-center",
        "org_type": "business",
        "website": "https://ec.co",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["community"],
        "description": "Startup hub offering coworking, accelerators, mentorship, and entrepreneurial events and workshops.",
        "instagram": "thenec",
        "facebook": "nashvilleentrepreneursclub",
        "twitter": "TheNEC",
    },
    {
        "name": "Music City Center",
        "slug": "music-city-center",
        "org_type": "convention_center",
        "website": "https://nashvillemcc.com",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["community"],
        "description": "Major convention center hosting conferences, trade shows, concerts, and large public events.",
        "instagram": "musiccitycenter",
        "facebook": "MusicCityCenter",
        "twitter": "MusicCityCenter",
    },

    # ========== LGBTQ+ ORGANIZATIONS ==========
    {
        "name": "Nashville Pride",
        "slug": "nashville-pride",
        "org_type": "lgbtq",
        "website": "https://nashvillepride.org",
        "city": "Nashville",
        "categories": ["community", "nightlife"],
        "description": "Organizes annual Pride Festival & Parade, year-round events supporting LGBTQ+ community and equality.",
        "instagram": "nashvillepride",
        "facebook": "NashvillePride",
        "twitter": "NashvillePride",
    },
    {
        "name": "Tennessee Equality Project",
        "slug": "tennessee-equality-project",
        "org_type": "lgbtq",
        "website": "https://tnequality.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "Statewide LGBTQ+ advocacy organization working for equality through policy, education, and community events.",
        "instagram": "tnequality",
        "facebook": "TNEquality",
        "twitter": "TNEquality",
    },
    {
        "name": "OUTMemphis Nashville",
        "slug": "outmemphis-nashville",
        "org_type": "lgbtq",
        "website": "https://outmemphis.org",
        "city": "Nashville",
        "categories": ["community"],
        "description": "LGBTQ+ community center (expanded from Memphis) offering social events, support groups, and resources.",
        "instagram": "outmemphis",
        "facebook": "OUTMemphis",
    },

    # ========== SUBURBAN/REGIONAL ==========
    {
        "name": "Downtown Franklin Association",
        "slug": "downtown-franklin-association",
        "org_type": "business",
        "website": "https://downtownfranklintn.com",
        "city": "Franklin",
        "categories": ["community"],
        "description": "Manages events and promotions for historic downtown Franklin including Dickens of a Christmas and Main Street Festival.",
        "instagram": "downtownfranklintn",
        "facebook": "DowntownFranklinTN",
    },
    {
        "name": "Heritage Foundation of Franklin and Williamson County",
        "slug": "heritage-foundation-franklin",
        "org_type": "nonprofit",
        "website": "https://historicfranklin.com",
        "city": "Franklin",
        "categories": ["community", "art"],
        "description": "Preserves and promotes local history through museums, tours, and educational events in Williamson County.",
        "instagram": "historicfranklin",
        "facebook": "HeritageFoundationTN",
    },
    {
        "name": "Rutherford Arts Alliance",
        "slug": "rutherford-arts-alliance",
        "org_type": "arts_nonprofit",
        "website": "https://rutherfordartsalliance.org",
        "city": "Murfreesboro",
        "categories": ["art", "music", "theater"],
        "description": "Supports artists and arts programming in Rutherford County. Hosts events, exhibitions, and workshops.",
        "facebook": "RutherfordArtsAlliance",
    },
    {
        "name": "Williamson County Parks and Recreation",
        "slug": "williamson-county-parks",
        "org_type": "government",
        "website": "https://www.wcparksandrec.com",
        "city": "Franklin",
        "categories": ["fitness", "family", "community"],
        "description": "Public parks system offering nature programs, sports leagues, fitness classes, and outdoor events.",
        "facebook": "WilliamsonCountyParks",
        "instagram": "wcparksandrec",
    },

    # ========== FILM & THEATER ==========
    {
        "name": "Nashville Film Festival",
        "slug": "nashville-film-festival",
        "org_type": "film_society",
        "website": "https://nashvillefilmfestival.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["film"],
        "description": "Annual film festival showcasing independent cinema. Year-round film screenings and filmmaker events.",
        "instagram": "nashvillefilmfest",
        "facebook": "NashvilleFilmFestival",
        "twitter": "NashFilmFest",
    },
    {
        "name": "Nashville Repertory Theatre",
        "slug": "nashville-repertory-theatre",
        "org_type": "performing_arts",
        "website": "https://nashvillerep.org",
        "city": "Nashville",
        "neighborhood": "TPAC District",
        "categories": ["theater"],
        "description": "Professional theater company producing contemporary and classic plays at TPAC's Johnson Theater.",
        "instagram": "nashvillerep",
        "facebook": "NashvilleRepertoryTheatre",
        "twitter": "NashvilleRep",
    },
    {
        "name": "Circle Players Nashville",
        "slug": "circle-players-nashville",
        "org_type": "performing_arts",
        "website": "https://circleplayers.net",
        "city": "Nashville",
        "categories": ["theater"],
        "description": "Community theater company producing musicals, comedies, and dramas with local talent.",
        "facebook": "CirclePlayersNashville",
    },
    {
        "name": "Nashville Children's Theatre",
        "slug": "nashville-childrens-theatre",
        "org_type": "performing_arts",
        "website": "https://nashvillechildrenstheatre.org",
        "city": "Nashville",
        "categories": ["theater", "family"],
        "description": "Theater dedicated to young audiences. Professional productions, drama classes, and education programs.",
        "instagram": "nashvillechildrenstheatre",
        "facebook": "NashvilleChildrensTheatre",
        "twitter": "NCTNashville",
    },

    # ========== CULTURAL & HERITAGE ==========
    {
        "name": "National Museum of African American Music",
        "slug": "national-museum-african-american-music",
        "org_type": "museum",
        "website": "https://nmaam.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music", "art"],
        "description": "Museum celebrating Black music genres and artists. Interactive exhibits, live performances, educational programs.",
        "instagram": "nmaamuseum",
        "facebook": "NMAAMuseum",
        "twitter": "NMAAMuseum",
    },
    {
        "name": "Country Music Hall of Fame and Museum",
        "slug": "country-music-hall-of-fame",
        "org_type": "museum",
        "website": "https://countrymusichalloffame.org",
        "city": "Nashville",
        "neighborhood": "Downtown",
        "categories": ["music", "art"],
        "description": "Iconic museum preserving country music history. Exhibits, archives, concerts, and Hatch Show Print letterpress.",
        "instagram": "countrymusichof",
        "facebook": "CountryMusicHallofFame",
        "twitter": "CountryMusicHOF",
    },
    {
        "name": "Historic RCA Studio B",
        "slug": "rca-studio-b",
        "org_type": "museum",
        "website": "https://countrymusichalloffame.org/rca-studio-b",
        "city": "Nashville",
        "neighborhood": "Music Row",
        "categories": ["music", "art"],
        "description": "Legendary recording studio where Elvis, Dolly Parton, and thousands of hits were made. Guided tours available.",
    },
    {
        "name": "Cheekwood Estate & Gardens",
        "slug": "cheekwood-estate-gardens",
        "org_type": "museum",
        "website": "https://cheekwood.org",
        "city": "Nashville",
        "neighborhood": "West Nashville",
        "categories": ["art", "family"],
        "description": "Historic mansion, art museum, and 55-acre botanical garden. Seasonal exhibitions, concerts, and family events.",
        "instagram": "cheekwood",
        "facebook": "Cheekwood",
        "twitter": "Cheekwood",
    },
    {
        "name": "The Parthenon",
        "slug": "the-parthenon-nashville",
        "org_type": "museum",
        "website": "https://www.nashville.gov/departments/parks/parthenon",
        "city": "Nashville",
        "neighborhood": "West End",
        "categories": ["art"],
        "description": "Full-scale replica of Athens Parthenon in Centennial Park. Art museum with rotating exhibits and Athena statue.",
    },
    {
        "name": "Adventure Science Center",
        "slug": "adventure-science-center",
        "org_type": "museum",
        "website": "https://adventuresci.org",
        "city": "Nashville",
        "categories": ["family", "community"],
        "description": "Hands-on science museum with planetarium. Interactive exhibits, space programs, and STEM education events.",
        "instagram": "adventuresci",
        "facebook": "AdventureScienceCenter",
        "twitter": "AdventureSci",
    },

    # ========== SPORTS & RECREATION ==========
    {
        "name": "Nashville Sports Council",
        "slug": "nashville-sports-council",
        "org_type": "nonprofit",
        "website": "https://nashvillesports.com",
        "city": "Nashville",
        "categories": ["sports"],
        "description": "Recruits and manages sporting events for Nashville. Organizes races, tournaments, and athletic competitions.",
        "instagram": "nashvillesportscouncil",
        "facebook": "NashvilleSports",
        "twitter": "NashvilleSports",
    },
    {
        "name": "Music City Runners Club",
        "slug": "music-city-runners",
        "org_type": "nonprofit",
        "website": "https://www.musiccityrunners.com",
        "city": "Nashville",
        "categories": ["sports", "fitness"],
        "description": "Running club organizing group runs, training programs, and local race events.",
        "facebook": "MusicCityRunnersClub",
    },

    # ========== NEIGHBORHOOD ASSOCIATIONS ==========
    {
        "name": "East Nashville Business Association",
        "slug": "east-nashville-business",
        "org_type": "business",
        "website": "https://www.eastnashvillebiz.com",
        "city": "Nashville",
        "neighborhood": "East Nashville",
        "categories": ["community"],
        "description": "Promotes East Nashville businesses and organizes community events, shop local campaigns, and networking.",
        "instagram": "eastnashvillebiz",
        "facebook": "EastNashvilleBusinessAssociation",
    },
    {
        "name": "12 South Neighborhood Association",
        "slug": "12-south-neighborhood",
        "org_type": "neighborhood",
        "website": "https://12southnashville.com",
        "city": "Nashville",
        "neighborhood": "12 South",
        "categories": ["community"],
        "description": "Supports vibrant 12 South district with events, beautification projects, and neighborhood initiatives.",
        "instagram": "12southnashville",
        "facebook": "12SouthNashville",
    },
    {
        "name": "The Nations Neighborhood",
        "slug": "the-nations-neighborhood",
        "org_type": "neighborhood",
        "city": "Nashville",
        "neighborhood": "The Nations",
        "categories": ["community"],
        "description": "Growing neighborhood west of Germantown with community events, art projects, and local business support.",
        "facebook": "TheNationsNashville",
    },

    # ========== FOOD & BEVERAGE ==========
    {
        "name": "Nashville Craft Distillery",
        "slug": "nashville-craft-distillery",
        "org_type": "business",
        "website": "https://nashvillecraftdistillery.com",
        "city": "Nashville",
        "neighborhood": "Wedgewood-Houston",
        "categories": ["food_drink"],
        "description": "Craft distillery offering tours, tastings, and special events showcasing local spirits production.",
        "instagram": "nashvillecraftdistillery",
        "facebook": "NashvilleCraftDistillery",
    },
    {
        "name": "Tennessee Craft",
        "slug": "tennessee-craft",
        "org_type": "nonprofit",
        "website": "https://tennesseecraft.org",
        "city": "Nashville",
        "categories": ["art", "food_drink"],
        "description": "Supports local craft artisans, brewers, and makers. Hosts Tennessee Craft Fair and craft beverage events.",
        "instagram": "tennesseecraft",
        "facebook": "TennesseeCraft",
    },
]


def import_organizations():
    """Import Nashville Metro organizations to event_producers table."""
    client = get_client()
    
    success_count = 0
    error_count = 0
    
    for org in NASHVILLE_ORGS:
        try:
            # Check if organization already exists
            result = client.table("event_producers").select("id").eq("slug", org["slug"]).execute()
            
            if result.data and len(result.data) > 0:
                # Update existing
                logger.info(f"Updating existing: {org['name']}")
                client.table("event_producers").update(org).eq("slug", org["slug"]).execute()
            else:
                # Insert new
                logger.info(f"Inserting new: {org['name']}")
                client.table("event_producers").insert(org).execute()
            
            success_count += 1
            
        except Exception as e:
            logger.error(f"Error importing {org['name']}: {e}")
            error_count += 1
    
    logger.info(f"\n=== Import Complete ===")
    logger.info(f"Successfully imported: {success_count}")
    logger.info(f"Errors: {error_count}")
    logger.info(f"Total organizations: {len(NASHVILLE_ORGS)}")


if __name__ == "__main__":
    import_organizations()
